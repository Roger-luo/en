<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Not every post is provided with an English version (eg. novels)">
    

    <!--Author-->
    
        <meta name="author" content="Roger Luo">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="量子深度学习笔记/Notes on quantum deep learning"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Not every post is provided with an English version (eg. novels)" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Half Integer"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>量子深度学习笔记/Notes on quantum deep learning - Half Integer</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Half Integer</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="https://Roger-luo.github.io/en/">
                            
                                English
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/">
                            
                                主页
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/cv">
                            
                                CV
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/codes">
                            
                                代码
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://Roger-luo.github.io/slides/">
                            
                                幻灯片
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                文档
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Roger-luo/Roger-luo.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="post-header" style="background-image: url('/img/home-bg-2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>量子深度学习笔记/Notes on quantum deep learning</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2016-04-04
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        

<a href="/categories/Algorithms/">Algorithms</a>

                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Nathan&#x7684;&#x8FD9;&#x7BC7;&#x91CF;&#x5B50;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x7ED9;&#x51FA;&#x4E86;&#x4E24;&#x4E2A;&#x8BAD;&#x7EC3;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x7684;&#x65B9;&#x6CD5;.&#x4E00;&#x4E2A;&#x662F;CEQS,&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;&#x91CF;&#x5B50;&#x62BD;&#x6837;&#x7684;&#x68AF;&#x5EA6;&#x4F30;&#x8BA1;&#x65B9;&#x6CD5;. &#x53E6;&#x5916;&#x4E00;&#x4E2A;CEQAE&#x662F;&#x57FA;&#x4E8E;&#x91CF;&#x5B50;&#x632F;&#x5E45;&#x4F30;&#x8BA1;&#x7684;&#x68AF;&#x5EA6;&#x4F30;&#x8BA1;&#x65B9;&#x6CD5;.&#x8FD9;&#x4E24;&#x4E2A;&#x7B97;&#x6CD5;&#x4E3B;&#x8981;&#x662F;&#x89E3;&#x51B3;&#x4E4B;&#x524D;&#x7684;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;&#x5E76;&#x6CA1;&#x6709;&#x5C55;&#x73B0;&#x51FA;&#x5F88;&#x597D;&#x7684;&#x91CF;&#x5B50;&#x52A0;&#x901F;&#x6548;&#x5E94;. &#x800C;&#x5728;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x4E2D;,&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;,&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x5DF2;&#x7ECF;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x88AB;&#x53D8;&#x4E3A;&#x591A;&#x9879;&#x5F0F;&#x7EA7;&#x4E86;(&#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x7684;CD-k&#x7684;&#x7B97;&#x6CD5;&#x800C;&#x8A00;).</p>
<p>&#x6587;&#x7AE0;&#x7684;&#x51FA;&#x53D1;&#x70B9;&#x4F9D;&#x7136;&#x662F;&#x4E4B;&#x524D;&#x7814;&#x7A76;&#x8FC7;&#x5F88;&#x591A;&#x7684;&#x91CF;&#x5B50;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;,&#x4EE5;&#x53CA;&#x4ECE;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;Nathan&#x5728;&#x53BB;&#x5E74;&#x7684;QIP(&#x91CF;&#x5B50;&#x4FE1;&#x606F;&#x5904;&#x7406;&#x4F1A;&#x8BAE;)&#x4E0A;&#x63D0;&#x51FA;&#x7684;&#x8BAD;&#x7EC3;&#x5168;&#x8FDE;&#x63A5;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x7684;&#x60F3;&#x6CD5;.</p>
<h1 id="bo-er-zi-man-ji"><a href="#bo-er-zi-man-ji" class="header-anchor">#</a> &#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;</h1>
<p>&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x662F;&#x4E00;&#x79CD;&#x6982;&#x7387;&#x578B;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;, &#x5B83;&#x7684;&#x8BAD;&#x7EC3;&#x76EE;&#x6807;&#x662F;&#x4F7F;&#x5F97;&#x80FD;&#x91CF;E&#x6700;&#x4F4E;.</p>
<p><span class="math display">\[
E(v,h) = -\sum_{i}  v_i b_i -\sum_{j}  h_j d_j - \sum_{i,j} \omega_{i,j} ^{vh} v_i h_j - \sum_{i,j} \omega_{i,j} ^{v}  v_i v_j -\sum_{i,j}  \omega_{i,j} ^{h}  h_i h_j
\]</span></p>
<p>&#x7136;&#x540E;&#x8BAD;&#x7EC3;&#x7684;&#x76EE;&#x6807;&#x53EF;&#x4EE5;&#x662F;&#x5C06;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F18;&#x5316;&#x5230;&#x6781;&#x503C;:</p>
<p><span class="math display">\[
O_{ML}  := \frac{1} {N_{train} } \sum_{v\in train} \log(\sum_{h=1} ^{n_h} P(v,h))-\frac{\lambda} {2}  \omega^T \omega
\]</span></p>
<p>&#x6784;&#x9020;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x4E3B;&#x8981;&#x7684;&#x601D;&#x8DEF;&#x5B9E;&#x9645;&#x4E0A;&#x5E76;&#x4E0D;&#x590D;&#x6742;,&#x7528;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x8868;&#x793A;&#x5904;&#x4E8E;0&#x6216;&#x8005;1&#x72B6;&#x6001;&#x7684;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x795E;&#x7ECF;&#x5143;(unit),&#x90A3;&#x4E48;&#x7531;&#x4E8E;&#x91CF;&#x5B50;&#x529B;&#x5B66;&#x672C;&#x8EAB;&#x5177;&#x6709;&#x7684;&#x7279;&#x6027;,&#x6574;&#x4E2A;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x505A;&#x662F;&#x4E00;&#x4E2A;&#x91CF;&#x5B50;&#x6001;. &#x5E76;&#x4E14;&#x6BCF;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x90FD;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x6982;&#x7387;&#x51FA;&#x73B0;,&#x89C2;&#x6D4B;&#x540E;,&#x8FD9;&#x4E2A;&#x91CF;&#x5B50;&#x6001;&#x6709;&#x53EF;&#x80FD;&#x6309;&#x7167;&#x5236;&#x5907;&#x51FA;&#x7684;&#x6982;&#x7387;&#x584C;&#x7F29;&#x81F3;&#x4EFB;&#x4E00;&#x53EF;&#x80FD;&#x7684;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x7684;&#x72B6;&#x6001;.&#x8FD9;&#x6837;&#x5C31;&#x6070;&#x597D;&#x7B26;&#x5408;&#x7ECF;&#x5178;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x7684;&#x7ED3;&#x6784;. &#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;,&#x6BD4;&#x5982;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x8868;&#x793A;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x7684;&#x67D0;&#x4E00;&#x4E2A;&#x72B6;&#x6001;.</p>
<p><span class="math display">\[
\|0001110101\rangle\otimes\|0110101101\rangle
\]</span></p>
<p>&#x524D;&#x9762;&#x662F;visible unit&#x7684;&#x72B6;&#x6001;,&#x540E;&#x9762;&#x662F;hidden unit&#x7684;&#x72B6;&#x6001;.&#x800C;&#x5B9E;&#x9645;&#x4E0A;&#x6574;&#x4E2A;&#x91CF;&#x5B50;&#x6001;&#x662F;&#x6309;&#x7167;&#x67D0;&#x79CD;&#x6982;&#x7387;&#x5206;&#x5E03;&#x7684;. &#x7ECF;&#x8FC7;&#x4E00;&#x4E9B;&#x8BA1;&#x7B97;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5236;&#x5907;&#x51FA;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x6982;&#x7387;&#x5206;&#x5E03;&#x7684;&#x91CF;&#x5B50;&#x6001;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x67D0;&#x4E00;&#x4E2A;&#x8BAD;&#x7EC3;&#x8FC7;&#x7684;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;.</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|P(v,h)\rangle(\sqrt{1-P(v,h)} \|0\rangle+\sqrt{P(v,h)} \|1\rangle)
\]</span></p>
<p>&#x7136;&#x540E;&#x4F5C;&#x8005;&#x7ED9;&#x51FA;&#x4E86;&#x51E0;&#x79CD;&#x8BAD;&#x7EC3;&#x7B97;&#x6CD5;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x548C;&#x6240;&#x9700;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x7684;&#x4E2A;&#x6570;.</p>
<table style="width:28%;">
<colgroup>
<col width="5%">
<col width="9%">
<col width="12%">
</colgroup>
<thead>
<tr class="header">
<th align="left">&#x7B97;&#x6CD5;</th>
<th align="left">&#x64CD;&#x4F5C;&#x6570;</th>
<th align="left">&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ML</td>
<td align="left"><span class="math inline">\(O(N_{training} 2^{n_v+n_k} )\)</span></td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">CD-k</td>
<td align="left"><span class="math inline">\(O(N_{training} lEk)\)</span></td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">CEQS</td>
<td align="left"><span class="math inline">\(O(N_{training} E(\sqrt{\kappa} +\max_{x} {\sqrt{\kappa_x} } ))\)</span></td>
<td align="left"><span class="math inline">\(O(n_h+n_v+\log{1/\epsilon} )\)</span></td>
</tr>
<tr class="even">
<td align="left">CEQAE</td>
<td align="left"><span class="math inline">\(O(\sqrt{N_{training} } E^2(\sqrt{\kappa} +\max_{x} {\sqrt{\kappa_x} } ))\)</span></td>
<td align="left"><span class="math inline">\(O(n_h+n_v+\log{1/\epsilon} )\)</span></td>
</tr>
</tbody>
</table>
<hr>
<p>&#x8BB0;&#x53F7;:</p>
<ul>
<li>Q&#x662F;&#x5409;&#x5E03;&#x65AF;&#x5206;&#x5E03;<span class="math inline">\(P = \exp{-E} /Z\)</span>&#x7684;&#x4E00;&#x4E2A;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;</li>
<li>&#x5C06;<span class="math inline">\(Q_x\)</span>&#x8BB0;&#x505A;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x7684;&#x6837;&#x4F8B;x&#x8FDE;&#x63A5;&#x7684;visible unit&#x7684;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;</li>
</ul>
<p>&#x7136;&#x540E;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7684;&#x6570;&#x5B66;&#x5F62;&#x5F0F;&#x662F;&#x8FD9;&#x6837;&#x7684;</p>
<p><span class="math display">\[
Z_Q = \sum_{v,h}  Q(v,h)\log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x5C06;&#x539F;&#x5148;&#x7684;&#x914D;&#x5206;&#x51FD;&#x6570;<span class="math inline">\(Z\)</span>&#x8FD1;&#x4F3C;&#x4E3A;<span class="math inline">\(Z_Q\)</span></p>
<p>&#x7136;&#x540E;&#x5236;&#x5907;&#x7B97;&#x6CD5;&#x7684;&#x4F2A;&#x4EE3;&#x7801;&#x662F;&#x8FD9;&#x6837;&#x7684;:</p>
<p>&#x9996;&#x5148;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x7684;bias&#x548C;&#x8FDE;&#x63A5;&#x7684;&#x6743;&#x91CD;<span class="math inline">\(\omega\)</span>&#x786E;&#x5B9A;&#x51FA;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7684;&#x53C2;&#x6570;<span class="math inline">\(\mu\)</span>,<span class="math inline">\(v\)</span>.&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x540E;&#x7684;&#x5206;&#x5E03;&#x51FD;&#x6570;<span class="math inline">\(Z_Q\)</span></p>
<p>&#x5236;&#x5907;&#x6001;</p>
<p><span class="math display">\[
\sum_{v,h}  \sqrt{Q(v,h)} \|v\rangle\|h\rangle := (\Pi_{i=1} ^{n_v}  e^{-i\sqrt{\mu_i} Y}  \|0\rangle)(\Pi_{j=1} ^{n_h}  e^{-i\sqrt{v_j} Y}  \|0\rangle)
\]</span></p>
<p>&#x518D;&#x5411;&#x5176;&#x4E2D;&#x6DFB;&#x52A0;&#x5BC4;&#x5B58;&#x6BD4;&#x7279;&#x6765;&#x8BB0;&#x5F55;&#x80FD;&#x91CF;&#x503C;:<span class="math inline">\(\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle\)</span></p>
<p>&#x7136;&#x540E;&#x901A;&#x8FC7;&#x91CF;&#x5B50;&#x95E8;&#x6765;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;(&#x7B2C;i&#x4E2A;)visible unit&#x8FDB;&#x884C;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_i b_i+\ln(\mu_{i} ^{v_i} (1-\mu_i)^{1-v_i} )
\]</span></p>
<p>&#x518D;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;(&#x7B2C;j&#x4E2A;)hidden unit: <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle&#x2192;\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+h_jd_j+\ln(v_j^{h_j} (1-v_j)^{1-h_j} )\rangle
\]</span></p>
<p>&#x7136;&#x540E;&#x5BF9;&#x4E8E;&#x91CF;&#x5B50;&#x6001;&#x7684;&#x5236;&#x5907;, &#x6587;&#x4E2D;&#x5229;&#x7528;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7ED9;&#x51FA;&#x4E86;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;.</p>
<h1 id="liang-zi-tai-de-zhi-bei-suan-fa"><a href="#liang-zi-tai-de-zhi-bei-suan-fa" class="header-anchor">#</a> &#x91CF;&#x5B50;&#x6001;&#x7684;&#x5236;&#x5907;&#x7B97;&#x6CD5;</h1>
<p><em>&#x5B9A;&#x4E49; 1</em>: &#x8BB0;Q&#x662F;&#x5409;&#x5E03;&#x65AF;&#x5206;&#x5E03; <span class="math inline">\(P = \exp{-E} /Z\)</span> &#x7684;&#x8FD1;&#x4F3C;&#x5C31;&#x6709; <span class="math display">\[
Z_Q := \sum_{v,h}  Q(v,h) \log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>&#x5B9A;&#x4E49;$Q_{x} <span class="math inline">\(&#x662F;&#x5BF9;x (\)</span>xx_{training} $, $x_{training} $&#x662F;&#x8BAD;&#x7EC3;&#x7684;&#x6570;&#x636E;&#x96C6;)&#x76F8;&#x8FDE;&#x63A5;&#x7684;visible unit&#x7684;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;</p>
<p><span class="math display">\[
Z_{x,Q}  := \sum_{h}  Q_x(x,h)\log(\frac{e^{-E(v,h)} } {Q_x(x,h)} )
\]</span></p>
<hr>
<p>&#x4E3A;&#x4E86;&#x4ECE;Q&#x5236;&#x5907;&#x51FA;P,&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4F30;&#x8BA1;&#x51FA;&#x4E00;&#x4E2A;&#x4E0A;&#x754C; (<em>&#x8FD9;&#x91CC;&#x4E0D;&#x592A;&#x6E05;&#x695A;&#x4E3A;&#x5565;&#x8981;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x4E0A;&#x754C;?</em>)</p>
<p><em>&#x5B9A;&#x4E49; 2</em> &#x8BB0;<span class="math inline">\(\kappa&gt;0\)</span>&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x7684; <span class="math inline">\((v,h)\)</span> &#x90FD;&#x6EE1;&#x8DB3;</p>
<p><span class="math display">\[
\frac{e^{-E(v,h)} } {Z_Q} \leq \kappa Q(v,h)
\]</span></p>
<p>&#x8FD9;&#x91CC;<span class="math inline">\(Z_Q\)</span>&#x662F;&#x5BF9;&#x914D;&#x5206;&#x51FD;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x8FD1;&#x4F3C;</p>
<hr>
<p><em>&#x5B9A;&#x4E49; 3</em> &#x8BB0;<span class="math inline">\(\kappa_x&gt;0\)</span> &#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x6570;&#x4F7F;&#x5F97;$xx_{training} $&#x548C;&#x6240;&#x6709;&#x7684;hidden unit&#x90FD;&#x6EE1;&#x8DB3;</p>
<p><span class="math display">\[
\frac{e^{-E(x,h)} } {Z_{x,Q} } \leq \kappa_x Q_{x} (x,h)
\]</span></p>
<p>&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;</p>
<p><span class="math display">\[
Q(v,h) = (\Pi_{i} \mu_i^{v_i} (1-\mu_i)^{1-v_i} )(\Pi_j v_j^{h_j} (1-v_j)^{1-h_j} )
\]</span></p>
<p>&#x8FD9;&#x91CC;<span class="math inline">\(\mu_i\)</span>&#x548C;<span class="math inline">\(v_j\)</span>&#x662F;&#x4F7F;&#x5F97;<span class="math inline">\(KL(Q\|\|P)\)</span>&#x6700;&#x5C0F;&#x7684;&#x5E73;&#x5747;&#x573A;&#x53C2;&#x6570;.</p>
<p><span class="math display">\[
\begin{aligned}
KL(Q\|\|P) &amp;= \sum_{v,h} -Q(v,h)\ln(P(v,h))+Q(v,h)\ln(Q(v,h))\\\\
&amp;= \sum_{v,h}  Q(v,h)(\sum_i v_i b_i+\sum_{j} h_j d_j +\sum_{i,j} \omega_{i,j} \mu_i v_j +\ln(Z)) + Q(v,h)\ln(Q(v,h))\\\\
&amp;= \sum_{i} \mu_i b_i +\sum_j v_j d_j +\sum_{i,j} \omega_{i,j} \mu_i v_j +\ln(Z)\\\\
&amp;+\sum_i \mu_i \ln(\mu_i)+(1-\mu_i)\ln(1-\mu_i)+\sum_{j} v_j\ln(v_j) + (1-v_j)\ln(1-v_j)
\end{aligned}
\]</span></p>
<p>&#x5BF9;<span class="math inline">\(KL(Q\|\|P)\)</span>&#x8FDB;&#x884C;&#x5FAE;&#x5206;&#x540E;,&#x53EF;&#x4EE5;&#x6C42;&#x5F97;&#x5176;&#x53D6;&#x6700;&#x5C0F;&#x503C;&#x65F6;,<span class="math inline">\(\mu_i\)</span>&#x548C;<span class="math inline">\(v_j\)</span>&#x7684;&#x53D6;&#x503C;:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \sigma(-b_i+\sum_{j} \omega_{i,j} v_j)\\\\
v_j   &amp;= \sigma(-d_j-\sum_{i} \omega_{i,j} \mu_i)
\end{aligned}
\]</span></p>
<p>&#x8FD9;&#x91CC;<span class="math inline">\(\sigma(x) = 1/(1+\exp(-x))\)</span></p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x6709;</p>
<p><span class="math display">\[
\log(Z_Q) = \log(Z) - KL(Q||P)
\]</span></p>
<hr>
<p><em>&#x63A8;&#x8BBA; 1</em> &#x5BF9;&#x6240;&#x6709;&#x7684;hidden unit&#x548C;visible unit&#x90FD;&#x6709;</p>
<p><span class="math display">\[
P(v,h)\leq\frac{e^{-E(v,h)} } {Z_Q} \leq \kappa Q(v,h)
\]</span></p>
<p>&#x8BC1;&#x660E;:</p>
<p>&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4F30;&#x8BA1;&#x914D;&#x5206;&#x51FD;&#x6570;&#x7684;&#x4E0B;&#x754C;, &#x7531;Jensen&#x4E0D;&#x7B49;&#x5F0F;</p>
<p><span class="math display">\[
\log(Z) = \log(\sum_{v,h} \frac{Q(v,h)e^{-E(v,h)} } {Q(v,h)} )\geq\sum_{v,h} Q(v,h)\log(\frac{e^{-E(v,h)} } {Q(v,h)} ) = \log(Z_Q)
\]</span></p>
<p>&#x4E4B;&#x524D;&#x7684;&#x5B9A;&#x4E49;&#x662F;&#x4E0D;&#x662F;&#x5C11;&#x4E86;&#x4E2A;log?&#x56E0;&#x4E3A;<span class="math inline">\(Z_Q\)</span>&#x5728;&#x4E4B;&#x524D;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;</p>
<p><span class="math display">\[
Z_Q := \sum_{v,h}  Q(v,h) \log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>&#x6240;&#x4EE5;&#x5C31;&#x6709;<span class="math inline">\(Z_Q\leq Z\)</span>, &#x6240;&#x4EE5;</p>
<p><span class="math display">\[
P(v,h) = \frac{e^{-E(v,h)} } {Z} \leq \frac{e^{E(v,h)} } {Z_Q}
\]</span></p>
<p><em>&#x63A8;&#x8BBA; 2</em> Boltzmann&#x673A;&#x7684;&#x5409;&#x5E03;&#x65AF;&#x6001;&#x53EF;&#x4EE5;&#x4EE5;$ <span class="math inline">\(&#x7684;&#x6982;&#x7387;&#x6210;&#x529F;&#x5236;&#x5907;. &#x540C;&#x65F6;&#x4E0E;&#x6570;&#x636E;&#x96C6;&#x76F8;&#x8FDE;&#x7684;visible unit&#x53EF;&#x4EE5;&#x901A;&#x8FC7;\)</span> $&#x7684;&#x6982;&#x7387;&#x5236;&#x5907;.</p>
<p>&#x8BC1;&#x660E;:</p>
<p>&#x9996;&#x5148;&#x901A;&#x8FC7;</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \sigma(-b_i+\sum_{j} \omega_{i,j} v_j)\\\
v_j   &amp;= \sigma(-d_j-\sum_{i} \omega_{i,j} \mu_i)
\end{aligned}
\]</span></p>
<p>&#x786E;&#x5B9A;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7684;&#x7CFB;&#x6570;. &#x8FD9;&#x4E9B;&#x7CFB;&#x6570;&#x5C31;&#x552F;&#x4E00;&#x5730;&#x786E;&#x5B9A;&#x4E86;&#x5E73;&#x5747;&#x573A;&#x5206;&#x5E03;Q,&#x7136;&#x540E;&#x7528;&#x5B83;&#x6765;&#x8FD1;&#x4F3C;&#x914D;&#x5206;&#x51FD;&#x6570;<span class="math inline">\(Z\)</span>&#x548C;<span class="math inline">\(Z_x\)</span></p>
<p>&#x6709;&#x4E86;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7684;&#x7CFB;&#x6570;,&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x5BF9;&#x5355;&#x6BD4;&#x7279;&#x7684;&#x65CB;&#x8F6C;</p>
<p><span class="math display">\[
\|\psi_Q\rangle := \Pi_{i}  R_y(2\arcsin(\sqrt{\mu_i} ))\|0\rangle\Pi_{j}  R_y(2\arcsin(\sqrt{v_j} ))\|0\rangle = \sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle
\]</span></p>
<p>&#x7136;&#x540E;&#x5C31;&#x9700;&#x8981;&#x901A;&#x8FC7;reject sampling&#x6765;&#x83B7;&#x5F97;<span class="math inline">\(\sum_{v,h} \sqrt{P(v,h)} \|v\rangle\|h\rangle\)</span>&#x7684;&#x8FD1;&#x4F3C;</p>
<p>&#x8BB0;</p>
<p><span class="math display">\[
\mathbf{P} (v,h):=\frac{e^{-E(v,h)} } {\kappa Z_Q Q(v,h)}
\]</span></p>
<p><span class="math inline">\(\mathbf{P} (v,h)\)</span>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5E73;&#x5747;&#x573A;&#x7CFB;&#x6570;&#x6709;&#x6548;&#x5730;&#x8BA1;&#x7B97;&#x51FA;&#x6765;. &#x540C;&#x65F6;&#x63A8;&#x8BBA;&#x4E00;&#x4E5F;&#x4FDD;&#x8BC1;&#x4E86;<span class="math inline">\(\mathbf{P} (v,h)\)</span>&#x5728;(0,1)&#x4E4B;&#x95F4;&#x7684;</p>
<p>&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x4E2A;&#x6001;</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle
\]</span></p>
<p>&#x53D8;&#x4E3A;</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle
\]</span></p>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6765;&#x83B7;&#x5F97;&#x76EE;&#x6807;&#x7684;&#x6001;</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle\|0\rangle \rightarrow \sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle(\sqrt{1-\mathbf{P} (v,h)} \|0\rangle+\sqrt{\mathbf{P} (v,h)} \|1\rangle)
\]</span></p>
<p>&#x7136;&#x540E;&#x5BF9;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6D4B;&#x91CF;, &#x5C31;&#x80FD;&#x4EE5;&#x4E00;&#x5B9A;&#x6982;&#x7387;&#x83B7;&#x5F97;</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)\mathbf{P} (v,h)} \|v\rangle\|h\rangle = \sqrt{\frac{Z} {\kappa Z_Q} } \sum_{v,h} \sqrt{\frac{e^{-E(v,h)} } {Z} } \|v\rangle\|h\rangle=\sqrt{\frac{Z} {\kappa Z_Q} } \sum_{v,h} \sqrt{P(v,h)} \|v\rangle\|h\rangle
\]</span></p>
<p>&#x7B97;&#x6CD5;&#x4E00;&#x7684;&#x4F2A;&#x4EE3;&#x7801;:</p>
<ul>
<li>&#x5148;&#x4ECE;<span class="math inline">\(\omega\)</span>,b,d&#x8BA1;&#x7B97;&#x5E73;&#x5747;&#x573A;&#x7CFB;&#x6570;<span class="math inline">\(\mu\)</span>,<span class="math inline">\(v\)</span></li>
<li>&#x83B7;&#x5F97;&#x5E73;&#x5747;&#x573A;&#x914D;&#x5206;&#x51FD;&#x6570;<span class="math inline">\(Z_Q\)</span></li>
<li>&#x5236;&#x5907;&#x6001;: <span class="math inline">\(\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle:=(\Pi_{i=1} ^{n_v} e^{-i\sqrt{\mu_i} Y} \|0\rangle)(\Pi_{i=1} ^{n_h} e^{-i\sqrt{v_j} Y} \|0\rangle)\)</span></li>
<li>&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x6BD4;&#x7279;:</li>
</ul>
<p><span class="math display">\[
\sum_{v,h}  \sqrt{Q(v,h)} \|v\rangle\|h\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle
\]</span></p>
<p><strong>for</strong> i = 1:<span class="math inline">\(n_v\)</span> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow \sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|E(v,h)+v_ib_i+\ln(\mu_i^{v_i} (1-\mu_{i} )^{1-h_j} )\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> j=1:<span class="math inline">\(n_h\)</span> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_i h_j\omega_{i,j} \rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> (i,j)<span class="math inline">\(\in\)</span> E <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_ih_j\omega_{i,j} \rangle
\]</span> <strong>end</strong> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle(\sqrt{\frac{e^{E(v,h)} } {Z_Q\kappa} } \|1\rangle+\sqrt{1-\frac{e^{E(v,h)} } {Z_Q\kappa} } \|0\rangle)
\]</span></p>
<h3 id="suan-fa-er"><a href="#suan-fa-er" class="header-anchor">#</a> &#x7B97;&#x6CD5;&#x4E8C;</h3>
<p>&#x5BF9;&#x7B97;&#x6CD5;&#x4E00;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x5C0F;&#x7684;&#x4FEE;&#x6539;, &#x5C06;<span class="math inline">\(Q\)</span>&#x66FF;&#x6362;&#x4E3A;<span class="math inline">\(Q_x\)</span>,&#x5C31;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8BAD;&#x7EC3;&#x51FA;&#x9700;&#x8981;&#x7684;<span class="math inline">\(\sum_i\sqrt{Q(x,h)} |x\rangle|h\rangle\)</span>&#x6001;,</p>
<p><strong>function</strong> qGenDataState(<span class="math inline">\(\omega\)</span>,b,d,E,<span class="math inline">\(\kappa_x\)</span>,x)</p>
<p>&#x8BA1;&#x7B97;&#x5E73;&#x5747;&#x573A;&#x7CFB;&#x6570;v</p>
<p>&#x8BA1;&#x7B97;&#x5E73;&#x5747;&#x573A;&#x8FD1;&#x4F3C;&#x7684;&#x914D;&#x5206;&#x51FD;&#x6570; $Z_{x,Q} $</p>
<p><strong>for</strong> i=1:<span class="math inline">\(n_v\)</span> <span class="math display">\[
\sum_{h}  \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)\rangle\rightarrow \sum_{h} \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)+x_ib_i\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> j=1:<span class="math inline">\(n_h\)</span> <span class="math display">\[
\sum_{h}  \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)\rangle\rightarrow\sum_{h} \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)+h_jd_j+\ln(v_j^{h_j} (1-v_j)^{1-h_j} )\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> (i,j)<span class="math inline">\(\in\)</span>E <strong>do</strong> <span class="math display">\[
\sum_{h} \sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)\rangle\rightarrow\sum_h\sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)+x_ih_j\omega_{ij} \rangle
\]</span> <strong>end</strong></p>
<p><strong>return</strong> <span class="math display">\[
\sum_h \sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)\rangle(\sqrt{\frac{e^{-E(x,h)} } {Z_{x,Q} \kappa_x} } |1\rangle+\sqrt{1-\frac{e^{-E(x,h)} } {Z_{x,Q} \kappa_x} } |0\rangle)
\]</span> <strong>end</strong></p>
<h2 id="xun-lian-suan-fa"><a href="#xun-lian-suan-fa" class="header-anchor">#</a> &#x8BAD;&#x7EC3;&#x7B97;&#x6CD5;</h2>
<p>&#x8FD9;&#x662F;&#x7528;&#x7C7B;Julia&#x8BED;&#x8A00;&#x5199;&#x7684;&#x6A21;&#x62DF;&#x8FD9;&#x4E2A;&#x91CF;&#x5B50;&#x7B97;&#x6CD5;&#x7684;&#x6570;&#x503C;&#x6A21;&#x62DF;&#x7B97;&#x6CD5;&#x4F2A;&#x4EE3;&#x7801;, &#x8FD9;&#x662F;&#x5BF9;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;epoch&#x7684;&#x8BAD;&#x7EC3;&#x8FC7;&#x7A0B;</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># &#x5BF9;&#x6BCF;&#x4E2A;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x8FDB;&#x884C;&#x8BAD;&#x7EC3;(&#x5236;&#x5907;&#x73BB;&#x5C14;&#x5179;&#x66FC;&#x673A;&#x6001;)</span></div><div class="line"><span class="keyword">for</span> i=<span class="number">1</span>:n_train</div><div class="line">    success = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> success = <span class="number">0</span></div><div class="line">        &#x3C8; = QuGenModelState(&#x3C9;,b,d,E,&#x3BA;)</div><div class="line">        <span class="comment"># &#x8FD9;&#x662F;&#x6D4B;&#x91CF;&#x7684;&#x90E8;&#x5206;, &#x7528;&#x8499;&#x5361;&#x6765;&#x6A21;&#x62DF;&#x6D4B;&#x91CF;</span></div><div class="line">        dice = rand()</div><div class="line">        <span class="keyword">if</span> dice &lt; <span class="literal">e</span>^(-E)/(Z*&#x3BA;_x)</div><div class="line">            success = <span class="number">1</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="comment"># modelVUnits &#x548C; modelHUnits &#x90FD;&#x662F;&#x77E9;&#x9635;, &#x7528;&#x6765;&#x5BF9;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x7684;&#x6D4B;&#x91CF;&#x7ED3;&#x679C;</span></div><div class="line">    modelVUnits[:,i] = measure_visible_unit(&#x3C8;)</div><div class="line">    modelHUnits[:,i] = measure_hidden_unit(&#x3C8;)</div><div class="line"></div><div class="line">    success = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> success = <span class="number">0</span></div><div class="line">        <span class="comment"># &#x7528;&#x548C;visiable unit&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x751F;&#x6210;Data model, &#x4E5F;&#x5C31;&#x662F;&#x7B97;&#x6CD5; 2</span></div><div class="line">        &#x3C8; = qGenDataState(&#x3C9;,b,d,E,&#x3BA;,x_train[i])</div><div class="line">        <span class="comment"># &#x6D4B;&#x91CF;</span></div><div class="line">        dice = rand()</div><div class="line">        <span class="keyword">if</span> dice &lt; <span class="literal">e</span>^(-E/Z_xQ*&#x3BA;)</div><div class="line">            success = <span class="number">1</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="comment"># dataVUnit &#x548C; dataHUnit &#x662F;&#x7528;&#x6765;&#x5B58;&#x50A8;&#x7B97;&#x6CD5; 2&#x83B7;&#x5F97;&#x7684;&#x6001;&#x7684;&#x6D4B;&#x91CF;&#x7ED3;&#x679C;(&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x7684;)</span></div><div class="line">        dataVUnit[:,i] = measure_visible_unit(&#x3C8;)</div><div class="line">        dataHUnit[:,i] = measure_hidden_unit(&#x3C8;)</div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="comment"># &#x5230;&#x8FD9;&#x91CC;&#x5236;&#x5907;&#x548C;&#x8BAD;&#x7EC3;&#x5C31;&#x7ED3;&#x675F;&#x4E86;</span></div><div class="line">    <span class="comment"># &#x7136;&#x540E;&#x8BA1;&#x7B97;&#x7528;&#x6765;&#x4F18;&#x5316;&#x8BAD;&#x7EC3;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x7684;&#x68AF;&#x5EA6;</span></div><div class="line">    <span class="comment"># &#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7B80;&#x5199;&#x4E86;&#x4E24;&#x4E2A;for&#x5FAA;&#x73AF;</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> eachindex(v),j <span class="keyword">in</span> eachindex(h)</div><div class="line">    gradMLw[i,j] = learning_rate*(sum_k(dataVUnit[i,k]*dataHUnit[j,k]-</div><div class="line">    modelVUnits[i,k]*modelHUnits[j,k]-&#x3BB;*&#x3C9;[i,j]))/n_train</div><div class="line">    <span class="comment">###################</span></div><div class="line">    gradMLb[i] = learning_rate*(sum_k(dataVUnit[i,k]-modelVUnits[k,i]))</div><div class="line">    gradMLd[j] = learning_rate*(sum_k(dataHUnit[i,k]-modelHUnits[k,i]))</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>&#x4E4B;&#x540E;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x68AF;&#x5EA6;&#x66F4;&#x65B0;b,d&#x8FD8;&#x6709;$_{ij} $&#x5373;&#x53EF;</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-2016-05-01-quantum-deep-learning" data-title="量子深度学习笔记/Notes on quantum deep learning" data-url="http://Roger-luo.github.com/2016/04/04/2016-05-01-quantum-deep-learning/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'rogerluo'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
            </script>
        <!-- 多说公共JS代码 end -->
    </section>

                </div>
            
        </div>
    </div>
</article>


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/Roger-luo" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a onclick="alert('Email me to get my wechat XD ')" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:hiroger@qq.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                
                <div class="copyright text-muted">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                Click to see Roger Luo's friends :-)
                            </a>
                        </h4>
                    </div>
                <div id="collapseOne" class="panel-collapse collapse">
                
                <p class="copyright text-muted" style="margin-top: 7px">
                <a target="_blank" href="http://crduan.cc">Chenru Duan</a>
                </p>
                
                <p class="copyright text-muted" style="margin-top: 7px">
                <a target="_blank" href="http://chenjunwang.com">Chenjun Wang</a>
                </p>
                
                </div>
                </div>

                
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Waypoint -->
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/noframework.waypoints.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->
<!-- 
<script type="text/javascript">
    var disqus_shortname = 'rogerluo';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
 -->

<!-- MathJax -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
          processEscapes: true
        },
        TeX: {
          equationNumbers: {
            autoNumber: 'AMS'
          }
        },
        "HTML-CSS": {
          imageFont: null
        }
      });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.1-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor: pointer;">
    <span class="fa-stack fa-lg">
        <i class="fa fa-arrow-up fa-stack-1x"></i>
    </span>
</div>


<script src="/js/totop.js"></script>


</body>

</html>