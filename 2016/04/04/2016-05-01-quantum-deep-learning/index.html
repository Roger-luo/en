<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Not every post is provided with an English version (eg. novels)">
    

    <!--Author-->
    
        <meta name="author" content="Roger Luo">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="量子深度学习笔记/Notes on quantum deep learning"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Not every post is provided with an English version (eg. novels)" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Half Integer"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>量子深度学习笔记/Notes on quantum deep learning - Half Integer</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Half Integer</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="https://Roger-luo.github.io/en/">
                            
                                English
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/">
                            
                                主页
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/cv">
                            
                                CV
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/codes">
                            
                                代码
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://Roger-luo.github.io/slides/">
                            
                                幻灯片
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                文档
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Roger-luo/Roger-luo.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="post-header" style="background-image: url('/img/home-bg-2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>量子深度学习笔记/Notes on quantum deep learning</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2016-04-04
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        

<a href="/categories/Algorithms/">Algorithms</a>

                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Nathan的这篇量子深度学习实际上是给出了两个训练玻尔兹曼机的方法.一个是CEQS,是一个基于量子抽样的梯度估计方法. 另外一个CEQAE是基于量子振幅估计的梯度估计方法.这两个算法主要是解决之前的一些算法并没有展现出很好的量子加速效应. 而在这个算法中,我们就可以看到,时间复杂度已经有一部分被变为多项式级了(相对于传统的CD-k的算法而言).</p>
<p>文章的出发点依然是之前研究过很多的量子玻尔兹曼机,以及从这篇文章中可以看出Nathan在去年的QIP(量子信息处理会议)上提出的训练全连接玻尔兹曼机的想法.</p>
<h1 id="玻尔兹曼机">玻尔兹曼机</h1>
<p>玻尔兹曼机是一种概率型的神经网络, 它的训练目标是使得能量E最低.</p>
<p><span class="math display">\[
E(v,h) = -\sum_{i}  v_i b_i -\sum_{j}  h_j d_j - \sum_{i,j} \omega_{i,j} ^{vh} v_i h_j - \sum_{i,j} \omega_{i,j} ^{v}  v_i v_j -\sum_{i,j}  \omega_{i,j} ^{h}  h_i h_j
\]</span></p>
<p>然后训练的目标可以是将这个函数优化到极值:</p>
<p><span class="math display">\[
O_{ML}  := \frac{1} {N_{train} } \sum_{v\in train} \log(\sum_{h=1} ^{n_h} P(v,h))-\frac{\lambda} {2}  \omega^T \omega
\]</span></p>
<p>构造这样一个玻尔兹曼机主要的思路实际上并不复杂,用量子比特来表示处于0或者1状态的玻尔兹曼机神经元(unit),那么由于量子力学本身具有的特性,整个玻尔兹曼机就可以看做是一个量子态. 并且每一个状态都有一定的概率出现,观测后,这个量子态有可能按照制备出的概率塌缩至任一可能的玻尔兹曼机的状态.这样就恰好符合经典玻尔兹曼机的结构. 举个例子,比如可以这样表示玻尔兹曼机的某一个状态.</p>
<p><span class="math display">\[
\|0001110101\rangle\otimes\|0110101101\rangle
\]</span></p>
<p>前面是visible unit的状态,后面是hidden unit的状态.而实际上整个量子态是按照某种概率分布的. 经过一些计算我们只需要制备出满足以下概率分布的量子态就可以得到某一个训练过的玻尔兹曼机.</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|P(v,h)\rangle(\sqrt{1-P(v,h)} \|0\rangle+\sqrt{P(v,h)} \|1\rangle)
\]</span></p>
<p>然后作者给出了几种训练算法的时间复杂度和所需量子比特的个数.</p>
<table style="width:28%;">
<colgroup>
<col width="5%">
<col width="9%">
<col width="12%">
</colgroup>
<thead>
<tr class="header">
<th align="left">算法</th>
<th align="left">操作数</th>
<th align="left">量子比特数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ML</td>
<td align="left"><span class="math inline">\(O(N_{training} 2^{n_v+n_k} )\)</span></td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">CD-k</td>
<td align="left"><span class="math inline">\(O(N_{training} lEk)\)</span></td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">CEQS</td>
<td align="left"><span class="math inline">\(O(N_{training} E(\sqrt{\kappa} +\max_{x} {\sqrt{\kappa_x} } ))\)</span></td>
<td align="left"><span class="math inline">\(O(n_h+n_v+\log{1/\epsilon} )\)</span></td>
</tr>
<tr class="even">
<td align="left">CEQAE</td>
<td align="left"><span class="math inline">\(O(\sqrt{N_{training} } E^2(\sqrt{\kappa} +\max_{x} {\sqrt{\kappa_x} } ))\)</span></td>
<td align="left"><span class="math inline">\(O(n_h+n_v+\log{1/\epsilon} )\)</span></td>
</tr>
</tbody>
</table>
<hr>
<p>记号:</p>
<ul>
<li>Q是吉布斯分布<span class="math inline">\(P = \exp{-E} /Z\)</span>的一个平均场近似</li>
<li>将<span class="math inline">\(Q_x\)</span>记做训练集中的样例x连接的visible unit的平均场近似</li>
</ul>
<p>然后平均场近似的数学形式是这样的</p>
<p><span class="math display">\[
Z_Q = \sum_{v,h}  Q(v,h)\log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>这样我们就可以通过平均场近似将原先的配分函数<span class="math inline">\(Z\)</span>近似为<span class="math inline">\(Z_Q\)</span></p>
<p>然后制备算法的伪代码是这样的:</p>
<p>首先通过网络的bias和连接的权重<span class="math inline">\(\omega\)</span>确定出平均场近似的参数<span class="math inline">\(\mu\)</span>,<span class="math inline">\(v\)</span>.然后计算平均场近似后的分布函数<span class="math inline">\(Z_Q\)</span></p>
<p>制备态</p>
<p><span class="math display">\[
\sum_{v,h}  \sqrt{Q(v,h)} \|v\rangle\|h\rangle := (\Pi_{i=1} ^{n_v}  e^{-i\sqrt{\mu_i} Y}  \|0\rangle)(\Pi_{j=1} ^{n_h}  e^{-i\sqrt{v_j} Y}  \|0\rangle)
\]</span></p>
<p>再向其中添加寄存比特来记录能量值:<span class="math inline">\(\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle\)</span></p>
<p>然后通过量子门来对每一个(第i个)visible unit进行这样的操作</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_i b_i+\ln(\mu_{i} ^{v_i} (1-\mu_i)^{1-v_i} )
\]</span></p>
<p>再对每一个(第j个)hidden unit: <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle→\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+h_jd_j+\ln(v_j^{h_j} (1-v_j)^{1-h_j} )\rangle
\]</span></p>
<p>然后对于量子态的制备, 文中利用平均场近似给出了这样一个方法.</p>
<h1 id="量子态的制备算法">量子态的制备算法</h1>
<p><em>定义 1</em>: 记Q是吉布斯分布 <span class="math inline">\(P = \exp{-E} /Z\)</span> 的近似就有 <span class="math display">\[
Z_Q := \sum_{v,h}  Q(v,h) \log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>定义$Q_{x} <span class="math inline">\(是对x (\)</span>xx_{training} $, $x_{training} $是训练的数据集)相连接的visible unit的平均场近似</p>
<p><span class="math display">\[
Z_{x,Q}  := \sum_{h}  Q_x(x,h)\log(\frac{e^{-E(v,h)} } {Q_x(x,h)} )
\]</span></p>
<hr>
<p>为了从Q制备出P,我们需要估计出一个上界 (<em>这里不太清楚为啥要知道一个上界?</em>)</p>
<p><em>定义 2</em> 记<span class="math inline">\(\kappa&gt;0\)</span>是一个对所有可能的 <span class="math inline">\((v,h)\)</span> 都满足</p>
<p><span class="math display">\[
\frac{e^{-E(v,h)} } {Z_Q} \leq \kappa Q(v,h)
\]</span></p>
<p>这里<span class="math inline">\(Z_Q\)</span>是对配分函数的一个近似</p>
<hr>
<p><em>定义 3</em> 记<span class="math inline">\(\kappa_x&gt;0\)</span> 是一个常数使得$xx_{training} $和所有的hidden unit都满足</p>
<p><span class="math display">\[
\frac{e^{-E(x,h)} } {Z_{x,Q} } \leq \kappa_x Q_{x} (x,h)
\]</span></p>
<p>平均场近似</p>
<p><span class="math display">\[
Q(v,h) = (\Pi_{i} \mu_i^{v_i} (1-\mu_i)^{1-v_i} )(\Pi_j v_j^{h_j} (1-v_j)^{1-h_j} )
\]</span></p>
<p>这里<span class="math inline">\(\mu_i\)</span>和<span class="math inline">\(v_j\)</span>是使得<span class="math inline">\(KL(Q\|\|P)\)</span>最小的平均场参数.</p>
<p><span class="math display">\[
\begin{aligned}
KL(Q\|\|P) &amp;= \sum_{v,h} -Q(v,h)\ln(P(v,h))+Q(v,h)\ln(Q(v,h))\\\\
&amp;= \sum_{v,h}  Q(v,h)(\sum_i v_i b_i+\sum_{j} h_j d_j +\sum_{i,j} \omega_{i,j} \mu_i v_j +\ln(Z)) + Q(v,h)\ln(Q(v,h))\\\\
&amp;= \sum_{i} \mu_i b_i +\sum_j v_j d_j +\sum_{i,j} \omega_{i,j} \mu_i v_j +\ln(Z)\\\\
&amp;+\sum_i \mu_i \ln(\mu_i)+(1-\mu_i)\ln(1-\mu_i)+\sum_{j} v_j\ln(v_j) + (1-v_j)\ln(1-v_j)
\end{aligned}
\]</span></p>
<p>对<span class="math inline">\(KL(Q\|\|P)\)</span>进行微分后,可以求得其取最小值时,<span class="math inline">\(\mu_i\)</span>和<span class="math inline">\(v_j\)</span>的取值:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \sigma(-b_i+\sum_{j} \omega_{i,j} v_j)\\\\
v_j   &amp;= \sigma(-d_j-\sum_{i} \omega_{i,j} \mu_i)
\end{aligned}
\]</span></p>
<p>这里<span class="math inline">\(\sigma(x) = 1/(1+\exp(-x))\)</span></p>
<p>实际上就有</p>
<p><span class="math display">\[
\log(Z_Q) = \log(Z) - KL(Q||P)
\]</span></p>
<hr>
<p><em>推论 1</em> 对所有的hidden unit和visible unit都有</p>
<p><span class="math display">\[
P(v,h)\leq\frac{e^{-E(v,h)} } {Z_Q} \leq \kappa Q(v,h)
\]</span></p>
<p>证明:</p>
<p>平均场近似可以用来估计配分函数的下界, 由Jensen不等式</p>
<p><span class="math display">\[
\log(Z) = \log(\sum_{v,h} \frac{Q(v,h)e^{-E(v,h)} } {Q(v,h)} )\geq\sum_{v,h} Q(v,h)\log(\frac{e^{-E(v,h)} } {Q(v,h)} ) = \log(Z_Q)
\]</span></p>
<p>之前的定义是不是少了个log?因为<span class="math inline">\(Z_Q\)</span>在之前被定义为</p>
<p><span class="math display">\[
Z_Q := \sum_{v,h}  Q(v,h) \log(\frac{e^{-E(v,h)} } {Q(v,h)} )
\]</span></p>
<p>所以就有<span class="math inline">\(Z_Q\leq Z\)</span>, 所以</p>
<p><span class="math display">\[
P(v,h) = \frac{e^{-E(v,h)} } {Z} \leq \frac{e^{E(v,h)} } {Z_Q}
\]</span></p>
<p><em>推论 2</em> Boltzmann机的吉布斯态可以以$ <span class="math inline">\(的概率成功制备. 同时与数据集相连的visible unit可以通过\)</span> $的概率制备.</p>
<p>证明:</p>
<p>首先通过</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \sigma(-b_i+\sum_{j} \omega_{i,j} v_j)\\\
v_j   &amp;= \sigma(-d_j-\sum_{i} \omega_{i,j} \mu_i)
\end{aligned}
\]</span></p>
<p>确定平均场近似的系数. 这些系数就唯一地确定了平均场分布Q,然后用它来近似配分函数<span class="math inline">\(Z\)</span>和<span class="math inline">\(Z_x\)</span></p>
<p>有了平均场近似的系数,可以通过一系列对单比特的旋转</p>
<p><span class="math display">\[
\|\psi_Q\rangle := \Pi_{i}  R_y(2\arcsin(\sqrt{\mu_i} ))\|0\rangle\Pi_{j}  R_y(2\arcsin(\sqrt{v_j} ))\|0\rangle = \sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle
\]</span></p>
<p>然后就需要通过reject sampling来获得<span class="math inline">\(\sum_{v,h} \sqrt{P(v,h)} \|v\rangle\|h\rangle\)</span>的近似</p>
<p>记</p>
<p><span class="math display">\[
\mathbf{P} (v,h):=\frac{e^{-E(v,h)} } {\kappa Z_Q Q(v,h)}
\]</span></p>
<p><span class="math inline">\(\mathbf{P} (v,h)\)</span>可以通过平均场系数有效地计算出来. 同时推论一也保证了<span class="math inline">\(\mathbf{P} (v,h)\)</span>在(0,1)之间的</p>
<p>我们就可以将这个态</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle
\]</span></p>
<p>变为</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle
\]</span></p>
<p>然后我们可以通过增加一个辅助比特来获得目标的态</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle\|0\rangle \rightarrow \sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|\mathbf{P} (v,h)\rangle(\sqrt{1-\mathbf{P} (v,h)} \|0\rangle+\sqrt{\mathbf{P} (v,h)} \|1\rangle)
\]</span></p>
<p>然后对辅助比特测量, 就能以一定概率获得</p>
<p><span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)\mathbf{P} (v,h)} \|v\rangle\|h\rangle = \sqrt{\frac{Z} {\kappa Z_Q} } \sum_{v,h} \sqrt{\frac{e^{-E(v,h)} } {Z} } \|v\rangle\|h\rangle=\sqrt{\frac{Z} {\kappa Z_Q} } \sum_{v,h} \sqrt{P(v,h)} \|v\rangle\|h\rangle
\]</span></p>
<p>算法一的伪代码:</p>
<ul>
<li>先从<span class="math inline">\(\omega\)</span>,b,d计算平均场系数<span class="math inline">\(\mu\)</span>,<span class="math inline">\(v\)</span></li>
<li>获得平均场配分函数<span class="math inline">\(Z_Q\)</span></li>
<li>制备态: <span class="math inline">\(\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle:=(\Pi_{i=1} ^{n_v} e^{-i\sqrt{\mu_i} Y} \|0\rangle)(\Pi_{i=1} ^{n_h} e^{-i\sqrt{v_j} Y} \|0\rangle)\)</span></li>
<li>添加一个寄存比特:</li>
</ul>
<p><span class="math display">\[
\sum_{v,h}  \sqrt{Q(v,h)} \|v\rangle\|h\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|0\rangle
\]</span></p>
<p><strong>for</strong> i = 1:<span class="math inline">\(n_v\)</span> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow \sum_{v,h} \sqrt{Q(v,h)}  \|v\rangle\|h\rangle\|E(v,h)+v_ib_i+\ln(\mu_i^{v_i} (1-\mu_{i} )^{1-h_j} )\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> j=1:<span class="math inline">\(n_h\)</span> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_i h_j\omega_{i,j} \rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> (i,j)<span class="math inline">\(\in\)</span> E <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)+v_ih_j\omega_{i,j} \rangle
\]</span> <strong>end</strong> <span class="math display">\[
\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle\rightarrow\sum_{v,h} \sqrt{Q(v,h)} \|v\rangle\|h\rangle\|E(v,h)\rangle(\sqrt{\frac{e^{E(v,h)} } {Z_Q\kappa} } \|1\rangle+\sqrt{1-\frac{e^{E(v,h)} } {Z_Q\kappa} } \|0\rangle)
\]</span></p>
<h3 id="算法二">算法二</h3>
<p>对算法一进行一些小的修改, 将<span class="math inline">\(Q\)</span>替换为<span class="math inline">\(Q_x\)</span>,就可以用来训练出需要的<span class="math inline">\(\sum_i\sqrt{Q(x,h)} |x\rangle|h\rangle\)</span>态,</p>
<p><strong>function</strong> qGenDataState(<span class="math inline">\(\omega\)</span>,b,d,E,<span class="math inline">\(\kappa_x\)</span>,x)</p>
<p>计算平均场系数v</p>
<p>计算平均场近似的配分函数 $Z_{x,Q} $</p>
<p><strong>for</strong> i=1:<span class="math inline">\(n_v\)</span> <span class="math display">\[
\sum_{h}  \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)\rangle\rightarrow \sum_{h} \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)+x_ib_i\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> j=1:<span class="math inline">\(n_h\)</span> <span class="math display">\[
\sum_{h}  \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)\rangle\rightarrow\sum_{h} \sqrt{Q(x,h)} \|x\rangle\|h\rangle\|E(x,h)+h_jd_j+\ln(v_j^{h_j} (1-v_j)^{1-h_j} )\rangle
\]</span> <strong>end</strong></p>
<p><strong>for</strong> (i,j)<span class="math inline">\(\in\)</span>E <strong>do</strong> <span class="math display">\[
\sum_{h} \sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)\rangle\rightarrow\sum_h\sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)+x_ih_j\omega_{ij} \rangle
\]</span> <strong>end</strong></p>
<p><strong>return</strong> <span class="math display">\[
\sum_h \sqrt{Q(x,h)} |x\rangle|h\rangle|E(x,h)\rangle(\sqrt{\frac{e^{-E(x,h)} } {Z_{x,Q} \kappa_x} } |1\rangle+\sqrt{1-\frac{e^{-E(x,h)} } {Z_{x,Q} \kappa_x} } |0\rangle)
\]</span> <strong>end</strong></p>
<h2 id="训练算法">训练算法</h2>
<p>这是用类Julia语言写的模拟这个量子算法的数值模拟算法伪代码, 这是对一个数据集进行一个epoch的训练过程</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 对每个训练样本进行训练(制备玻尔兹曼机态)</span></div><div class="line"><span class="keyword">for</span> i=<span class="number">1</span>:n_train</div><div class="line">    success = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> success = <span class="number">0</span></div><div class="line">        ψ = QuGenModelState(ω,b,d,E,κ)</div><div class="line">        <span class="comment"># 这是测量的部分, 用蒙卡来模拟测量</span></div><div class="line">        dice = rand()</div><div class="line">        <span class="keyword">if</span> dice &lt; <span class="literal">e</span>^(-E)/(Z*κ_x)</div><div class="line">            success = <span class="number">1</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="comment"># modelVUnits 和 modelHUnits 都是矩阵, 用来对每个数据集的测量结果</span></div><div class="line">    modelVUnits[:,i] = measure_visible_unit(ψ)</div><div class="line">    modelHUnits[:,i] = measure_hidden_unit(ψ)</div><div class="line"></div><div class="line">    success = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> success = <span class="number">0</span></div><div class="line">        <span class="comment"># 用和visiable unit连接的数据生成Data model, 也就是算法 2</span></div><div class="line">        ψ = qGenDataState(ω,b,d,E,κ,x_train[i])</div><div class="line">        <span class="comment"># 测量</span></div><div class="line">        dice = rand()</div><div class="line">        <span class="keyword">if</span> dice &lt; <span class="literal">e</span>^(-E/Z_xQ*κ)</div><div class="line">            success = <span class="number">1</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">        <span class="comment"># dataVUnit 和 dataHUnit 是用来存储算法 2获得的态的测量结果(每一个数据集的)</span></div><div class="line">        dataVUnit[:,i] = measure_visible_unit(ψ)</div><div class="line">        dataHUnit[:,i] = measure_hidden_unit(ψ)</div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="comment"># 到这里制备和训练就结束了</span></div><div class="line">    <span class="comment"># 然后计算用来优化训练目标函数的梯度</span></div><div class="line">    <span class="comment"># 注意这里简写了两个for循环</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> eachindex(v),j <span class="keyword">in</span> eachindex(h)</div><div class="line">    gradMLw[i,j] = learning_rate*(sum_k(dataVUnit[i,k]*dataHUnit[j,k]-</div><div class="line">    modelVUnits[i,k]*modelHUnits[j,k]-λ*ω[i,j]))/n_train</div><div class="line">    <span class="comment">###################</span></div><div class="line">    gradMLb[i] = learning_rate*(sum_k(dataVUnit[i,k]-modelVUnits[k,i]))</div><div class="line">    gradMLd[j] = learning_rate*(sum_k(dataHUnit[i,k]-modelHUnits[k,i]))</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>之后按照这个梯度更新b,d还有$_{ij} $即可</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-2016-05-01-quantum-deep-learning" data-title="量子深度学习笔记/Notes on quantum deep learning" data-url="http://Roger-luo.github.com/2016/04/04/2016-05-01-quantum-deep-learning/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'rogerluo'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
            </script>
        <!-- 多说公共JS代码 end -->
    </section>

                </div>
            
        </div>
    </div>
</article>


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/Roger-luo" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a onclick="alert('Email me to get my wechat XD ')" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:hiroger@qq.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                
                <div class="copyright text-muted">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                Click to see Roger Luo's friends :-)
                            </a>
                        </h4>
                    </div>
                <div id="collapseOne" class="panel-collapse collapse">
                
                <p class="copyright text-muted" style="margin-top: 7px">
                <a target="_blank" href="http://crduan.cc">Chenru Duan</a>
                </p>
                
                <p class="copyright text-muted" style="margin-top: 7px">
                <a target="_blank" href="http://chenjunwang.com">Chenjun Wang</a>
                </p>
                
                </div>
                </div>

                
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Waypoint -->
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/noframework.waypoints.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->
<!-- 
<script type="text/javascript">
    var disqus_shortname = 'rogerluo';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
 -->

<!-- MathJax -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
          processEscapes: true
        },
        TeX: {
          equationNumbers: {
            autoNumber: 'AMS'
          }
        },
        "HTML-CSS": {
          imageFont: null
        }
      });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.1-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>

</html>